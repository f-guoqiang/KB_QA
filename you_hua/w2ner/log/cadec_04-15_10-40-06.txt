2022-04-15 10:40:06 - INFO: dict_items([('dataset', 'cadec'), ('save_path', './model.pt'), ('predict_path', './output.json'), ('dist_emb_size', 20), ('type_emb_size', 20), ('lstm_hid_size', 512), ('conv_hid_size', 80), ('bert_hid_size', 768), ('biaffine_size', 512), ('ffnn_hid_size', 120), ('dilation', [1, 2, 3]), ('emb_dropout', 0.5), ('conv_dropout', 0.5), ('out_dropout', 0.33), ('epochs', 10), ('batch_size', 16), ('learning_rate', 0.001), ('weight_decay', 0), ('clip_grad_norm', 5.0), ('bert_name', 'dmis-lab/biobert-base-cased-v1.2'), ('bert_learning_rate', 5e-06), ('warm_factor', 0), ('use_bert_last_4_layers', True), ('seed', 123), ('config', './config/cadec.json'), ('device', 0)])
2022-04-15 10:40:06 - INFO: Loading Data
2022-04-15 10:40:25 - INFO: 
+-------+-----------+----------+
| cadec | sentences | entities |
+-------+-----------+----------+
| train |    5340   |   4428   |
|  dev  |    1097   |   898    |
|  test |    1160   |   990    |
+-------+-----------+----------+
2022-04-15 10:40:31 - INFO: Building Model
2022-04-15 10:41:53 - INFO: Epoch: 0
2022-04-15 10:42:46 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 0 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0290 | 0.4960 |   0.6329  | 0.4461 |
+---------+--------+--------+-----------+--------+
2022-04-15 10:42:56 - INFO: EVAL Label F1 [0.99820372 0.66559226 0.6185567 ]
2022-04-15 10:42:56 - INFO: 
+--------+--------+-----------+--------+
| EVAL 0 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.7608 |   0.7890  | 0.7363 |
| Entity | 0.6176 |   0.7354  | 0.5323 |
+--------+--------+-----------+--------+
2022-04-15 10:43:08 - INFO: TEST Label F1 [0.99835893 0.66486851 0.6198491 ]
2022-04-15 10:43:08 - INFO: 
+--------+--------+-----------+--------+
| TEST 0 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.7610 |   0.8198  | 0.7154 |
| Entity | 0.6178 |   0.7906  | 0.5071 |
+--------+--------+-----------+--------+
2022-04-15 10:43:08 - INFO: Epoch: 1
2022-04-15 10:43:55 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 1 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0117 | 0.7146 |   0.8083  | 0.6568 |
+---------+--------+--------+-----------+--------+
2022-04-15 10:44:04 - INFO: EVAL Label F1 [0.99837868 0.67017544 0.68276249]
2022-04-15 10:44:04 - INFO: 
+--------+--------+-----------+--------+
| EVAL 1 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.7838 |   0.8184  | 0.7568 |
| Entity | 0.6598 |   0.7197  | 0.6091 |
+--------+--------+-----------+--------+
2022-04-15 10:44:15 - INFO: TEST Label F1 [0.9985451  0.66763425 0.71111111]
2022-04-15 10:44:15 - INFO: 
+--------+--------+-----------+--------+
| TEST 1 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.7924 |   0.8519  | 0.7485 |
| Entity | 0.6761 |   0.7727  | 0.6010 |
+--------+--------+-----------+--------+
2022-04-15 10:44:16 - INFO: Epoch: 2
2022-04-15 10:45:02 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 2 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0098 | 0.7747 |   0.8295  | 0.7326 |
+---------+--------+--------+-----------+--------+
2022-04-15 10:45:11 - INFO: EVAL Label F1 [0.99842885 0.70380991 0.68880135]
2022-04-15 10:45:11 - INFO: 
+--------+--------+-----------+--------+
| EVAL 2 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.7970 |   0.8126  | 0.7829 |
| Entity | 0.6735 |   0.7305  | 0.6247 |
+--------+--------+-----------+--------+
2022-04-15 10:45:21 - INFO: TEST Label F1 [0.99863128 0.71242919 0.73581011]
2022-04-15 10:45:21 - INFO: 
+--------+--------+-----------+--------+
| TEST 2 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8156 |   0.8418  | 0.7928 |
| Entity | 0.7062 |   0.7917  | 0.6374 |
+--------+--------+-----------+--------+
2022-04-15 10:45:22 - INFO: Epoch: 3
2022-04-15 10:46:08 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 3 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0084 | 0.8062 |   0.8452  | 0.7739 |
+---------+--------+--------+-----------+--------+
2022-04-15 10:46:18 - INFO: EVAL Label F1 [0.99830602 0.71073776 0.69745719]
2022-04-15 10:46:18 - INFO: 
+--------+--------+-----------+--------+
| EVAL 3 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8022 |   0.7738  | 0.8345 |
| Entity | 0.6870 |   0.6836  | 0.6904 |
+--------+--------+-----------+--------+
2022-04-15 10:46:28 - INFO: TEST Label F1 [0.99851493 0.73231132 0.72718765]
2022-04-15 10:46:28 - INFO: 
+--------+--------+-----------+--------+
| TEST 3 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8193 |   0.7926  | 0.8497 |
| Entity | 0.7150 |   0.7179  | 0.7121 |
+--------+--------+-----------+--------+
2022-04-15 10:46:28 - INFO: Epoch: 4
2022-04-15 10:47:14 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 4 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0075 | 0.8294 |   0.8574  | 0.8052 |
+---------+--------+--------+-----------+--------+
2022-04-15 10:47:24 - INFO: EVAL Label F1 [0.99832077 0.71750182 0.69673406]
2022-04-15 10:47:24 - INFO: 
+--------+--------+-----------+--------+
| EVAL 4 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8042 |   0.7744  | 0.8383 |
| Entity | 0.6905 |   0.6819  | 0.6993 |
+--------+--------+-----------+--------+
2022-04-15 10:47:33 - INFO: TEST Label F1 [0.99854973 0.73662908 0.74207288]
2022-04-15 10:47:33 - INFO: 
+--------+--------+-----------+--------+
| TEST 4 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8258 |   0.7968  | 0.8586 |
| Entity | 0.7292 |   0.7322  | 0.7263 |
+--------+--------+-----------+--------+
2022-04-15 10:47:34 - INFO: Epoch: 5
2022-04-15 10:48:20 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 5 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0067 | 0.8470 |   0.8700  | 0.8267 |
+---------+--------+--------+-----------+--------+
2022-04-15 10:48:29 - INFO: EVAL Label F1 [0.99848268 0.72651198 0.7113112 ]
2022-04-15 10:48:29 - INFO: 
+--------+--------+-----------+--------+
| EVAL 5 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8121 |   0.8094  | 0.8151 |
| Entity | 0.6929 |   0.7208  | 0.6670 |
+--------+--------+-----------+--------+
2022-04-15 10:48:40 - INFO: TEST Label F1 [0.99866973 0.73533007 0.7587269 ]
2022-04-15 10:48:40 - INFO: 
+--------+--------+-----------+--------+
| TEST 5 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8309 |   0.8329  | 0.8290 |
| Entity | 0.7368 |   0.7778  | 0.7000 |
+--------+--------+-----------+--------+
2022-04-15 10:48:40 - INFO: Epoch: 6
2022-04-15 10:49:25 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 6 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0060 | 0.8638 |   0.8810  | 0.8483 |
+---------+--------+--------+-----------+--------+
2022-04-15 10:49:35 - INFO: EVAL Label F1 [0.9984022  0.73037037 0.70441558]
2022-04-15 10:49:35 - INFO: 
+--------+--------+-----------+--------+
| EVAL 6 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8111 |   0.7853  | 0.8401 |
| Entity | 0.6920 |   0.6755  | 0.7094 |
+--------+--------+-----------+--------+
2022-04-15 10:49:45 - INFO: TEST Label F1 [0.99854784 0.72887842 0.74513526]
2022-04-15 10:49:45 - INFO: 
+--------+--------+-----------+--------+
| TEST 6 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8242 |   0.7996  | 0.8516 |
| Entity | 0.7270 |   0.7198  | 0.7343 |
+--------+--------+-----------+--------+
2022-04-15 10:49:45 - INFO: Epoch: 7
2022-04-15 10:50:30 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 7 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0054 | 0.8761 |   0.8872  | 0.8660 |
+---------+--------+--------+-----------+--------+
2022-04-15 10:50:40 - INFO: EVAL Label F1 [0.99846786 0.72493172 0.71130155]
2022-04-15 10:50:40 - INFO: 
+--------+--------+-----------+--------+
| EVAL 7 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8116 |   0.8037  | 0.8202 |
| Entity | 0.7023 |   0.7099  | 0.6949 |
+--------+--------+-----------+--------+
2022-04-15 10:50:50 - INFO: TEST Label F1 [0.99862484 0.72772431 0.75510204]
2022-04-15 10:50:50 - INFO: 
+--------+--------+-----------+--------+
| TEST 7 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8272 |   0.8196  | 0.8354 |
| Entity | 0.7276 |   0.7437  | 0.7121 |
+--------+--------+-----------+--------+
2022-04-15 10:50:51 - INFO: Epoch: 8
2022-04-15 10:51:38 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 8 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0050 | 0.8887 |   0.9001  | 0.8782 |
+---------+--------+--------+-----------+--------+
2022-04-15 10:51:47 - INFO: EVAL Label F1 [0.99849758 0.72253865 0.7141339 ]
2022-04-15 10:51:47 - INFO: 
+--------+--------+-----------+--------+
| EVAL 8 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8117 |   0.8130  | 0.8127 |
| Entity | 0.6989 |   0.7052  | 0.6927 |
+--------+--------+-----------+--------+
2022-04-15 10:51:58 - INFO: TEST Label F1 [0.99863594 0.72504039 0.74987952]
2022-04-15 10:51:58 - INFO: 
+--------+--------+-----------+--------+
| TEST 8 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8245 |   0.8257  | 0.8256 |
| Entity | 0.7240 |   0.7342  | 0.7141 |
+--------+--------+-----------+--------+
2022-04-15 10:51:58 - INFO: Epoch: 9
2022-04-15 10:52:45 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 9 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0045 | 0.8963 |   0.9016  | 0.8912 |
+---------+--------+--------+-----------+--------+
2022-04-15 10:52:54 - INFO: EVAL Label F1 [0.99850616 0.72676506 0.71521036]
2022-04-15 10:52:54 - INFO: 
+--------+--------+-----------+--------+
| EVAL 9 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8135 |   0.8126  | 0.8153 |
| Entity | 0.7005 |   0.7097  | 0.6915 |
+--------+--------+-----------+--------+
2022-04-15 10:53:04 - INFO: TEST Label F1 [0.99865679 0.73175355 0.75585937]
2022-04-15 10:53:04 - INFO: 
+--------+--------+-----------+--------+
| TEST 9 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8288 |   0.8268  | 0.8316 |
| Entity | 0.7298 |   0.7440  | 0.7162 |
+--------+--------+-----------+--------+
2022-04-15 10:53:04 - INFO: Best DEV F1: 0.7023
2022-04-15 10:53:04 - INFO: Best TEST F1: 0.7276
2022-04-15 10:53:14 - INFO: TEST Label F1 [0.99862484 0.72772431 0.75510204]
2022-04-15 10:53:14 - INFO: 
+------------+--------+-----------+--------+
| TEST Final |   F1   | Precision | Recall |
+------------+--------+-----------+--------+
|   Label    | 0.8272 |   0.8196  | 0.8354 |
|   Entity   | 0.7276 |   0.7437  | 0.7121 |
+------------+--------+-----------+--------+
