2022-04-15 11:03:34 - INFO: dict_items([('dataset', 'genia'), ('save_path', './model.pt'), ('predict_path', './output.json'), ('dist_emb_size', 20), ('type_emb_size', 20), ('lstm_hid_size', 512), ('conv_hid_size', 128), ('bert_hid_size', 768), ('biaffine_size', 512), ('ffnn_hid_size', 384), ('dilation', [1, 2, 3, 4]), ('emb_dropout', 0.5), ('conv_dropout', 0.5), ('out_dropout', 0.33), ('epochs', 10), ('batch_size', 8), ('learning_rate', 0.001), ('weight_decay', 0), ('clip_grad_norm', 5.0), ('bert_name', 'dmis-lab/biobert-v1.1'), ('bert_learning_rate', 5e-06), ('warm_factor', 0.1), ('use_bert_last_4_layers', False), ('seed', 123), ('config', './config/genia.json'), ('device', 0)])
2022-04-15 11:03:34 - INFO: Loading Data
2022-04-15 11:03:48 - INFO: 
+-------+-----------+----------+
| genia | sentences | entities |
+-------+-----------+----------+
| train |   15023   |  45144   |
|  dev  |    1669   |   5365   |
|  test |    1854   |   5506   |
+-------+-----------+----------+
2022-04-15 11:04:15 - INFO: Building Model
2022-04-15 11:04:20 - INFO: Epoch: 0
2022-04-15 11:07:56 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 0 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0707 | 0.3584 |   0.3636  | 0.4180 |
+---------+--------+--------+-----------+--------+
2022-04-15 11:08:09 - INFO: EVAL Label F1 [0.99865683 0.86254729 0.78529657 0.75407027 0.58665034 0.75
 0.73404255]
2022-04-15 11:08:09 - INFO: 
+--------+--------+-----------+--------+
| EVAL 0 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.7816 |   0.8131  | 0.7706 |
| Entity | 0.7508 |   0.7450  | 0.7566 |
+--------+--------+-----------+--------+
2022-04-15 11:08:23 - INFO: TEST Label F1 [0.9986664  0.87120486 0.75325856 0.7220339  0.65716999 0.70734745
 0.75376884]
2022-04-15 11:08:23 - INFO: 
+--------+--------+-----------+--------+
| TEST 0 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.7805 |   0.8122  | 0.7645 |
| Entity | 0.7298 |   0.7413  | 0.7187 |
+--------+--------+-----------+--------+
2022-04-15 11:08:24 - INFO: Epoch: 1
2022-04-15 11:11:47 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 1 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0075 | 0.7846 |   0.8174  | 0.7572 |
+---------+--------+--------+-----------+--------+
2022-04-15 11:12:00 - INFO: EVAL Label F1 [0.99905666 0.90608713 0.84978928 0.77966102 0.74300792 0.79142857
 0.7961165 ]
2022-04-15 11:12:00 - INFO: 
+--------+--------+-----------+--------+
| EVAL 1 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8379 |   0.8567  | 0.8228 |
| Entity | 0.8175 |   0.8379  | 0.7979 |
+--------+--------+-----------+--------+
2022-04-15 11:12:14 - INFO: TEST Label F1 [0.99900821 0.90720932 0.8193687  0.72951542 0.75821398 0.72586873
 0.83928571]
2022-04-15 11:12:14 - INFO: 
+--------+--------+-----------+--------+
| TEST 1 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8255 |   0.8544  | 0.8033 |
| Entity | 0.7894 |   0.8337  | 0.7495 |
+--------+--------+-----------+--------+
2022-04-15 11:12:15 - INFO: Epoch: 2
2022-04-15 11:15:35 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 2 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0063 | 0.8214 |   0.8434  | 0.8019 |
+---------+--------+--------+-----------+--------+
2022-04-15 11:15:49 - INFO: EVAL Label F1 [0.99908074 0.91146337 0.85755026 0.7996633  0.760364   0.81451613
 0.77272727]
2022-04-15 11:15:49 - INFO: 
+--------+--------+-----------+--------+
| EVAL 2 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8451 |   0.8294  | 0.8639 |
| Entity | 0.8332 |   0.8117  | 0.8559 |
+--------+--------+-----------+--------+
2022-04-15 11:16:02 - INFO: TEST Label F1 [0.99900419 0.90777237 0.82772399 0.74771024 0.76732673 0.75967175
 0.86343612]
2022-04-15 11:16:02 - INFO: 
+--------+--------+-----------+--------+
| TEST 2 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8389 |   0.8340  | 0.8462 |
| Entity | 0.8051 |   0.8016  | 0.8086 |
+--------+--------+-----------+--------+
2022-04-15 11:16:03 - INFO: Epoch: 3
2022-04-15 11:19:24 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 3 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0058 | 0.8340 |   0.8523  | 0.8176 |
+---------+--------+--------+-----------+--------+
2022-04-15 11:19:37 - INFO: EVAL Label F1 [0.99914988 0.91465474 0.87338108 0.78267974 0.78661494 0.8
 0.81171548]
2022-04-15 11:19:37 - INFO: 
+--------+--------+-----------+--------+
| EVAL 3 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8526 |   0.8319  | 0.8786 |
| Entity | 0.8397 |   0.8413  | 0.8380 |
+--------+--------+-----------+--------+
2022-04-15 11:19:51 - INFO: TEST Label F1 [0.99904233 0.90881992 0.82648478 0.7512275  0.78002378 0.7629108
 0.85355649]
2022-04-15 11:19:51 - INFO: 
+--------+--------+-----------+--------+
| TEST 3 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8403 |   0.8360  | 0.8471 |
| Entity | 0.8016 |   0.8249  | 0.7795 |
+--------+--------+-----------+--------+
2022-04-15 11:19:51 - INFO: Epoch: 4
2022-04-15 11:23:14 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 4 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0053 | 0.8464 |   0.8622  | 0.8321 |
+---------+--------+--------+-----------+--------+
2022-04-15 11:23:27 - INFO: EVAL Label F1 [0.99915689 0.91482837 0.87509372 0.78928571 0.78686918 0.81155433
 0.85128205]
2022-04-15 11:23:27 - INFO: 
+--------+--------+-----------+--------+
| EVAL 4 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8612 |   0.8735  | 0.8507 |
| Entity | 0.8454 |   0.8521  | 0.8388 |
+--------+--------+-----------+--------+
2022-04-15 11:23:40 - INFO: TEST Label F1 [0.99903488 0.90772457 0.82982853 0.74561404 0.7839236  0.74845105
 0.87562189]
2022-04-15 11:23:40 - INFO: 
+--------+--------+-----------+--------+
| TEST 4 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8415 |   0.8704  | 0.8175 |
| Entity | 0.8057 |   0.8283  | 0.7842 |
+--------+--------+-----------+--------+
2022-04-15 11:23:41 - INFO: Epoch: 5
2022-04-15 11:26:59 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 5 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0049 | 0.8582 |   0.8732  | 0.8444 |
+---------+--------+--------+-----------+--------+
2022-04-15 11:27:13 - INFO: EVAL Label F1 [0.99915118 0.90866463 0.87378039 0.78956522 0.77216495 0.79887482
 0.83937824]
2022-04-15 11:27:13 - INFO: 
+--------+--------+-----------+--------+
| EVAL 5 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8545 |   0.8814  | 0.8301 |
| Entity | 0.8380 |   0.8686  | 0.8095 |
+--------+--------+-----------+--------+
2022-04-15 11:27:26 - INFO: TEST Label F1 [0.9990588  0.90519878 0.82762131 0.74957118 0.77884215 0.76558603
 0.85714286]
2022-04-15 11:27:26 - INFO: 
+--------+--------+-----------+--------+
| TEST 5 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8404 |   0.8870  | 0.8011 |
| Entity | 0.7994 |   0.8537  | 0.7515 |
+--------+--------+-----------+--------+
2022-04-15 11:27:26 - INFO: Epoch: 6
2022-04-15 11:30:44 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 6 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0045 | 0.8651 |   0.8781  | 0.8532 |
+---------+--------+--------+-----------+--------+
2022-04-15 11:30:58 - INFO: EVAL Label F1 [0.99915732 0.91165019 0.88066215 0.78677111 0.77300613 0.8
 0.84466019]
2022-04-15 11:30:58 - INFO: 
+--------+--------+-----------+--------+
| EVAL 6 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8566 |   0.8690  | 0.8459 |
| Entity | 0.8438 |   0.8561  | 0.8319 |
+--------+--------+-----------+--------+
2022-04-15 11:31:12 - INFO: TEST Label F1 [0.99908302 0.91204925 0.83572828 0.74978504 0.77717618 0.7581864
 0.86699507]
2022-04-15 11:31:12 - INFO: 
+--------+--------+-----------+--------+
| TEST 6 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8427 |   0.8776  | 0.8134 |
| Entity | 0.8078 |   0.8404  | 0.7777 |
+--------+--------+-----------+--------+
2022-04-15 11:31:12 - INFO: Epoch: 7
2022-04-15 11:34:32 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 7 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0042 | 0.8701 |   0.8812  | 0.8598 |
+---------+--------+--------+-----------+--------+
2022-04-15 11:34:46 - INFO: EVAL Label F1 [0.99920339 0.91558312 0.88925719 0.79686138 0.78769841 0.80839161
 0.83      ]
2022-04-15 11:34:46 - INFO: 
+--------+--------+-----------+--------+
| EVAL 7 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8610 |   0.8722  | 0.8509 |
| Entity | 0.8518 |   0.8606  | 0.8432 |
+--------+--------+-----------+--------+
2022-04-15 11:34:59 - INFO: TEST Label F1 [0.99907927 0.91139241 0.84013051 0.74246339 0.77926286 0.75776398
 0.8358209 ]
2022-04-15 11:34:59 - INFO: 
+--------+--------+-----------+--------+
| TEST 7 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8380 |   0.8684  | 0.8123 |
| Entity | 0.8085 |   0.8340  | 0.7846 |
+--------+--------+-----------+--------+
2022-04-15 11:35:00 - INFO: Epoch: 8
2022-04-15 11:38:21 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 8 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0040 | 0.8797 |   0.8897  | 0.8704 |
+---------+--------+--------+-----------+--------+
2022-04-15 11:38:35 - INFO: EVAL Label F1 [0.99918784 0.91417837 0.88805409 0.79827586 0.7938856  0.8102288
 0.84651163]
2022-04-15 11:38:35 - INFO: 
+--------+--------+-----------+--------+
| EVAL 8 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8643 |   0.8586  | 0.8711 |
| Entity | 0.8547 |   0.8540  | 0.8555 |
+--------+--------+-----------+--------+
2022-04-15 11:38:49 - INFO: TEST Label F1 [0.99907614 0.91130647 0.84184994 0.74978796 0.7776886  0.76904474
 0.86111111]
2022-04-15 11:38:49 - INFO: 
+--------+--------+-----------+--------+
| TEST 8 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8443 |   0.8560  | 0.8342 |
| Entity | 0.8124 |   0.8253  | 0.7999 |
+--------+--------+-----------+--------+
2022-04-15 11:38:49 - INFO: Epoch: 9
2022-04-15 11:42:10 - INFO: 
+---------+--------+--------+-----------+--------+
| Train 9 |  Loss  |   F1   | Precision | Recall |
+---------+--------+--------+-----------+--------+
|  Label  | 0.0038 | 0.8851 |   0.8944  | 0.8766 |
+---------+--------+--------+-----------+--------+
2022-04-15 11:42:24 - INFO: EVAL Label F1 [0.99918824 0.91389276 0.88925471 0.78929188 0.78745645 0.80437756
 0.85714286]
2022-04-15 11:42:24 - INFO: 
+--------+--------+-----------+--------+
| EVAL 9 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8629 |   0.8634  | 0.8633 |
| Entity | 0.8528 |   0.8547  | 0.8509 |
+--------+--------+-----------+--------+
2022-04-15 11:42:38 - INFO: TEST Label F1 [0.99908092 0.91114616 0.84256278 0.74378749 0.77764277 0.7699877
 0.86666667]
2022-04-15 11:42:38 - INFO: 
+--------+--------+-----------+--------+
| TEST 9 |   F1   | Precision | Recall |
+--------+--------+-----------+--------+
| Label  | 0.8444 |   0.8649  | 0.8268 |
| Entity | 0.8117 |   0.8283  | 0.7957 |
+--------+--------+-----------+--------+
2022-04-15 11:42:38 - INFO: Best DEV F1: 0.8547
2022-04-15 11:42:38 - INFO: Best TEST F1: 0.8124
2022-04-15 11:42:51 - INFO: TEST Label F1 [0.99907614 0.91130647 0.84184994 0.74978796 0.7776886  0.76904474
 0.86111111]
2022-04-15 11:42:51 - INFO: 
+------------+--------+-----------+--------+
| TEST Final |   F1   | Precision | Recall |
+------------+--------+-----------+--------+
|   Label    | 0.8443 |   0.8560  | 0.8342 |
|   Entity   | 0.8124 |   0.8253  | 0.7999 |
+------------+--------+-----------+--------+
